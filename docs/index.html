<!DOCTYPE html>
<!-- saved from url=(0022)http://localhost:4686/ -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">


<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Unraveling Socioeconomic Factors in the U.S. Cancer Incidence : A Linear Modeling Approach</title>
<style class="anchorjs"></style><style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="./LinearModelingContentV3_files/clipboard.min.js"></script>
<script src="./LinearModelingContentV3_files/quarto.js"></script>
<script src="./LinearModelingContentV3_files/popper.min.js"></script>
<script src="./LinearModelingContentV3_files/tippy.umd.min.js"></script>
<script src="./LinearModelingContentV3_files/anchor.min.js"></script>
<link href="./LinearModelingContentV3_files/tippy.css" rel="stylesheet">
<link href="./LinearModelingContentV3_files/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="./LinearModelingContentV3_files/bootstrap.min.js"></script>
<link href="./LinearModelingContentV3_files/bootstrap-icons.css" rel="stylesheet">
<link href="./LinearModelingContentV3_files/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-full toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#modeling-tool-motivations" id="toc-modeling-tool-motivations" class="nav-link" data-scroll-target="#modeling-tool-motivations">Modeling Tool Motivations</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#modeling-tool-assumptions" id="toc-modeling-tool-assumptions" class="nav-link" data-scroll-target="#modeling-tool-assumptions">Modeling Tool Assumptions</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#data-preprocessing" id="toc-data-preprocessing" class="nav-link" data-scroll-target="#data-preprocessing">Data Preprocessing</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#feature-selection" id="toc-feature-selection" class="nav-link active" data-scroll-target="#feature-selection">Feature Selection</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#coefficient-inference" id="toc-coefficient-inference" class="nav-link" data-scroll-target="#coefficient-inference">Coefficient Inference</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#variable-interpretationconclusion" id="toc-variable-interpretationconclusion" class="nav-link" data-scroll-target="#variable-interpretationconclusion">Variable Interpretation/Conclusion</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#data-citation" id="toc-data-citation" class="nav-link" data-scroll-target="#data-citation">Data Citation</a></li>
  <li><a href="https://brandonorodriguez.github.io/Unraveling-Socioeconomic-Factors-in-U.S.-Cancer-Incidence-A-Linear-Modeling-Approach/#sources-cited" id="toc-sources-cited" class="nav-link" data-scroll-target="#sources-cited">Sources Cited</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Unraveling Socioeconomic Factors in the U.S. Cancer Incidence : A Linear Modeling Approach</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Created by Brandon Rodriguez under the advising of Professor Aiden McLoughlin at UC Berkeley.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#introduction" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Cancer is a leading cause of mortality in the United States, and understanding the factors that affect cancer mortality can help the federal government as well as state governments effectively allocate capital and resources in the correct areas. Using data on Cancer mortality and its factors, I hope to answer the research question: what socioeconomic and/or geographic factors most affect cancer mortality rates, and to what extent? Using my dataset, consisting of both yearly values and multi-year averages from cancer.gov, the American Community Survey, and clinicaltrials.gov, the focus of my project was causal inference on variables such as age, gender, race/ethnicity, socioeconomic status, geographic location, and more. Due to the issues of non-normality and linearity found in data exploration, I decided to use modeling tools that did not rely on these assumptions. Additionally, I focused on modeling tools that created a more parsimonious model, focusing on picking out the most impactful variables in exchange for less prediction accuracy.</p>
<p>The data set used consists of 3047 observations and 34 variables, where a unit of observation is a county in the United States. As mentioned previously, a variable can either be a value collected in a certain year, or an average over a period of years. For example, the dependent variable, “TARGET_deathRate” represents the Mean per capita (100,000) cancer mortalities between the years 2010 and 2016. In contrast, the variable “MedianAge” represents the median age of residents in a certain county coming from the 2013 Census Estimates. Since the aim of the study is causal inference, not prediction accuracy, as well as the difficulty of consistently measuring variables such as “MedianAge,” there does appear to be any significant temporal aspect to the results. The study is also done under the knowledge that the observations are perfectly independent, as state-wide trends can certainly affect specific variables compared to a different state, however this will be addressed by considering state and even region averages in our model. While there are gaps in certain variables due to not being collected in that county, for most variables this is insignificant and randomly placed (geographically) enough to consider the data set generalizable to the entire United States. Additionally, the use of multiple years in our data set will result in the results more robust and generalizable for the decade of 2010-2020, as well as possibly beyond that. Additional data not recorded in the dataset that may have improved the modeling is data on county occupation distributions, as it’s known that certain environmental factors, such as radiation, impact the incidence and thus death rate of cancer.</p>
</section>
<section id="modeling-tool-motivations" class="level2">
<h2 class="anchored" data-anchor-id="modeling-tool-motivations">Modeling Tool Motivations<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#modeling-tool-motivations" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Modeling was largely divided into two parts: feature selection and coefficient inference, and the modeling techniques used for each section were Lasso regression and Bootstrap confidence intervals, respectively. For feature selection, initial variables were chosen on the basis of domain knowledge and exploratory data analysis, constituting an initial model. Domain knowledge was also used to pick out a list of possibly important features, and then Lasso regression was used to create a final model. By using Lasso, I was able to effectively choose between a great deal of additional features, as well as eliminate any initial variables that were found to be unimportant. Additionally, by using the lambda value one standard error away from the minimum lambda value, I was able to obtain a far more sparse model than other methods. By using Bootstrap inference, I was able to not only obtain parameter inference without a normality assumption, but also help justify the use of imputation on missing values. By using these modeling techniques, I was able to create an answer to my research question that was focused on the most important features impacting cancer mortality, as well as without using improbable assumptions.</p>
</section>
<section id="modeling-tool-assumptions" class="level2">
<h2 class="anchored" data-anchor-id="modeling-tool-assumptions">Modeling Tool Assumptions<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#modeling-tool-assumptions" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>As mentioned prior, by using Lasso regression and Bootstrap inference, the assumptions I assumed about my model were homoskedasticity, linearity, and no excessive multicollinearity. I also am assuming that my sample is representative of the population.</p>
</section>
<section id="data-preprocessing" class="level2">
<h2 class="anchored" data-anchor-id="data-preprocessing">Data Preprocessing<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#data-preprocessing" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Unfortunately, the data does contain NA values, which were addressed by exclusion and imputation on certain variables. Since PctSomeCol18_24 (Percent of county residents ages 18-24 highest education attained: some college) has a NA rate of 74.99% I was comfortable excluding it, as it is too sparse to reasonably impute. PctEmployed16_Over (Percent of county residents ages 16 and over unemployed) has only a 4.99% NA rate. PctPublicCoverageAlone (Percent of county residents with government-provided health coverage alone) has a 19.99% NA rate, but seems too important to ignore if we wish to consider the status of coverage as a variable. All other variables do not contain NA values. I thus used MICE (Multiple Imputation by Chained Equations) to replace the NA values of these two variables with very likely substitutions using a method known as predictive mean matching. MICE operates under the assumption that the data missing is MAR (Missing at Random). Due to the data collection process (each row represents a county), the likely possible bias is that certain states refuse or fail to collect these variables in a systematic way, and thus the data is no longer MAR. I checked this assumption towards the end of modeling by considering the finalized model on both the imputed and reduced dataset (rows including NA’s for variables not excluded are removed), and assessed their similarities and differences. Regardless, variable selection will be done using the imputed dataset, assuming MAR, thus imputing 152 PctEmployed16_Over NA values and 609 PctPublicCoverageAlone NA values.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="http://localhost:4686/#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(tidyverse))</span>
<span id="cb1-2"><a href="http://localhost:4686/#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(usmap))</span>
<span id="cb1-3"><a href="http://localhost:4686/#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(scales))</span>
<span id="cb1-4"><a href="http://localhost:4686/#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(mice))</span>
<span id="cb1-5"><a href="http://localhost:4686/#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(glmnet))</span>
<span id="cb1-6"><a href="http://localhost:4686/#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(boot))</span>
<span id="cb1-7"><a href="http://localhost:4686/#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(grid))</span>
<span id="cb1-8"><a href="http://localhost:4686/#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(gridExtra))</span>
<span id="cb1-9"><a href="http://localhost:4686/#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressMessages</span>(<span class="fu">library</span>(cowplot))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="http://localhost:4686/#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data in and seprate State and County in to seperate columns, then edit any problematic entries and then create a new column of FIPS codes, that uniquelly identify a county</span></span>
<span id="cb2-2"><a href="http://localhost:4686/#cb2-2" aria-hidden="true" tabindex="-1"></a>cancer_raw <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"cancer_reg.csv"</span>)</span>
<span id="cb2-3"><a href="http://localhost:4686/#cb2-3" aria-hidden="true" tabindex="-1"></a>cancer_edit <span class="ot">=</span> cancer_raw</span>
<span id="cb2-4"><a href="http://localhost:4686/#cb2-4" aria-hidden="true" tabindex="-1"></a>cancer_edit <span class="ot">&lt;-</span> cancer_edit <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Target_div_Income =</span> TARGET_deathRate<span class="sc">/</span>medIncome)</span>
<span id="cb2-5"><a href="http://localhost:4686/#cb2-5" aria-hidden="true" tabindex="-1"></a>cancer_geo <span class="ot">=</span> <span class="fu">cbind</span>(cancer_edit, <span class="fu">str_match</span>(cancer_edit<span class="sc">$</span>Geography,<span class="st">"(.+), (.+)"</span>)[ ,<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb2-6"><a href="http://localhost:4686/#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cancer_geo)[<span class="dv">37</span>] <span class="ot">=</span><span class="st">"State"</span></span>
<span id="cb2-7"><a href="http://localhost:4686/#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cancer_geo)[<span class="dv">36</span>] <span class="ot">=</span> <span class="st">"County"</span></span>
<span id="cb2-8"><a href="http://localhost:4686/#cb2-8" aria-hidden="true" tabindex="-1"></a>cancer_geo[<span class="dv">167</span>,<span class="dv">36</span>] <span class="ot">&lt;-</span> <span class="st">"Dona Ana County"</span></span>
<span id="cb2-9"><a href="http://localhost:4686/#cb2-9" aria-hidden="true" tabindex="-1"></a>cancer_geo[<span class="dv">821</span>,<span class="dv">36</span>] <span class="ot">&lt;-</span> <span class="st">"La Salle Parish"</span></span>
<span id="cb2-10"><a href="http://localhost:4686/#cb2-10" aria-hidden="true" tabindex="-1"></a>codes <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NULL</span>, <span class="fu">length</span>(cancer_geo<span class="sc">$</span>County))</span>
<span id="cb2-11"><a href="http://localhost:4686/#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="http://localhost:4686/#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(cancer_geo<span class="sc">$</span>avgAnnCount)){</span>
<span id="cb2-13"><a href="http://localhost:4686/#cb2-13" aria-hidden="true" tabindex="-1"></a> codes[i] <span class="ot">=</span> <span class="fu">fips</span>(<span class="at">state =</span> cancer_geo<span class="sc">$</span>State[i], <span class="at">county =</span> cancer_geo<span class="sc">$</span>County[i])</span>
<span id="cb2-14"><a href="http://localhost:4686/#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="http://localhost:4686/#cb2-15" aria-hidden="true" tabindex="-1"></a>cancer_final <span class="ot">=</span> <span class="fu">cbind</span>(cancer_geo, <span class="at">fips =</span> codes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="http://localhost:4686/#cb3-1" aria-hidden="true" tabindex="-1"></a>moddat <span class="ot">&lt;-</span> cancer_final</span>
<span id="cb3-2"><a href="http://localhost:4686/#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="http://localhost:4686/#cb3-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">colMeans</span>(<span class="fu">is.na</span>(moddat)))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            avgAnnCount        avgDeathsPerYear        TARGET_deathRate 
               0.000000                0.000000                0.000000 
          incidenceRate               medIncome              popEst2015 
               0.000000                0.000000                0.000000 
         povertyPercent             studyPerCap               binnedInc 
               0.000000                0.000000                0.000000 
              MedianAge           MedianAgeMale         MedianAgeFemale 
               0.000000                0.000000                0.000000 
              Geography        AvgHouseholdSize          PercentMarried 
               0.000000                0.000000                0.000000 
           PctNoHS18_24              PctHS18_24         PctSomeCol18_24 
               0.000000                0.000000               74.991795 
        PctBachDeg18_24            PctHS25_Over       PctBachDeg25_Over 
               0.000000                0.000000                0.000000 
     PctEmployed16_Over    PctUnemployed16_Over      PctPrivateCoverage 
               4.988513                0.000000                0.000000 
PctPrivateCoverageAlone      PctEmpPrivCoverage       PctPublicCoverage 
              19.986872                0.000000                0.000000 
 PctPublicCoverageAlone                PctWhite                PctBlack 
               0.000000                0.000000                0.000000 
               PctAsian            PctOtherRace    PctMarriedHouseholds 
               0.000000                0.000000                0.000000 
              BirthRate       Target_div_Income                  County 
               0.000000                0.000000                0.000000 
                  State                    fips 
               0.000000                0.000000 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="http://localhost:4686/#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set reproducability seed and then impute data</span></span>
<span id="cb5-2"><a href="http://localhost:4686/#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb5-3"><a href="http://localhost:4686/#cb5-3" aria-hidden="true" tabindex="-1"></a>trim <span class="ot">=</span> moddat[,<span class="sc">-</span><span class="dv">18</span>]</span>
<span id="cb5-4"><a href="http://localhost:4686/#cb5-4" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">mice</span>(trim, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">maxit =</span> <span class="dv">50</span>, <span class="at">meth =</span> <span class="st">"pmm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Number of logged events: 505</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="http://localhost:4686/#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">complete</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-selection" class="level2">
<h2 class="anchored" data-anchor-id="feature-selection">Feature Selection<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#feature-selection" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Literature on socioeconomic factors affecting cancer mortality point to poverty, education, and race as some of the most important factors. In the 2017 paper “Socioeconomic and Racial/Ethnic Disparities in Cancer Mortality, Incidence, and Survival in the United States, 1950–2014: Over Six Decades of Changing Patterns and Widening Inequalities,” the authors concluded that individuals in lower income and education groups had significantly higher mortality and incidence rates (Singh and Jemal). The authors also noted that Blacks had higher mortality and incidence rates than other races, likely due to the interconnection of race and income. In the 2021 paper “Leading cancers contributing to educational disparities in cancer mortality in the US, 2017,” the authors concluded that there was a significant difference between the mortality rate between individuals with a bachelors degree and higher, and all education levels below that (Withrow, D. R Et al.). Since both these studies use data exclusively from the U.S., and are within the time frame of interest to us, I decided to use these conclusions to guide my variable selection. Prior visualization of the data set supports these conclusions as well as suggest a categorical variable indicating whether a given county is in the Southwest region. To define which states belong to the Southeast, I used the regions specified by the Bureau of Economic Analysis, who divide the United States into 8 regions (U.S. Bureau of Economic Analysis).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./LinearModelingContentV3_files/mapimage.jpg" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Additionally, the conclusions from the second paper suggest two new variables, PctNoHS18_24 (Percent of county residents ages 18-24 highest education attained: less than high school) and PctHS18_24 (Percent of county residents ages 18-24 highest education attained: high school diploma). While there are several other variables related to educational goals, such as percentage of county residents ages 18-24 who have attained a bachelors, the literature above suggests that residents with lower educational achievements tend to have a higher cancer mortality, while the opposite is not necessarily true. The variables for the initial model were thus povertyPercent (Percent of populace in poverty), PctBlack (Percent of county residents who identify as Black), and PctNoHS18 and PctHS18_24. For future investigation I decided to consider isSouthEast (Categorical variable indicating whether the county is in the South East), as well as the variables related to healthcare coverage, PctPublicCoverage (Percent of county residents with government-provided health coverage) and PctPublicCoverageAlone (Percent of county residents with government-provided health coverage alone), and a more nuanced poverty variable PctUnemployed16_Over (Percent of county residents ages 16 and over unemployed).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="http://localhost:4686/#cb8-1" aria-hidden="true" tabindex="-1"></a>imputed <span class="ot">&lt;-</span> <span class="fu">complete</span>(imp)</span>
<span id="cb8-2"><a href="http://localhost:4686/#cb8-2" aria-hidden="true" tabindex="-1"></a>imputed_new <span class="ot">&lt;-</span> imputed</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="http://localhost:4686/#cb9-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> imputed_new, TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctBlack <span class="sc">+</span> PctNoHS18_24 <span class="sc">+</span> PctHS18_24)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is the summary of the initial model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="http://localhost:4686/#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = TARGET_deathRate ~ povertyPercent + PctBlack + PctNoHS18_24 + 
    PctHS18_24, data = imputed_new)

Residuals:
     Min       1Q   Median       3Q      Max 
-106.595  -13.332    1.245   14.515  164.404 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    127.58734    2.10954  60.481  &lt; 2e-16 ***
povertyPercent   1.66957    0.08312  20.087  &lt; 2e-16 ***
PctBlack         0.13644    0.03527   3.869 0.000112 ***
PctNoHS18_24    -0.17345    0.05673  -3.058 0.002251 ** 
PctHS18_24       0.70898    0.04883  14.518  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 24.21 on 3042 degrees of freedom
Multiple R-squared:  0.2402,    Adjusted R-squared:  0.2392 
F-statistic: 240.4 on 4 and 3042 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The initial fit was rather weak, with a R-squared of 0.24. To add variables of interest, I used Lasso regression using a Lambda 1 standard error away from the minimum residual deviance Lambda value, both of which will be obtained using cross-validation.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="http://localhost:4686/#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#First, code the Southeast variable for future use</span></span>
<span id="cb12-2"><a href="http://localhost:4686/#cb12-2" aria-hidden="true" tabindex="-1"></a>new_england <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Connecticut"</span>, <span class="st">"Maine"</span>, <span class="st">"Massachusetts"</span>, <span class="st">"New Hampshire"</span>, <span class="st">"Rhode Island"</span>, <span class="st">"Vermont"</span>)</span>
<span id="cb12-3"><a href="http://localhost:4686/#cb12-3" aria-hidden="true" tabindex="-1"></a>mideast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Delaware"</span>, <span class="st">"District of Columbia"</span>, <span class="st">"Maryland"</span>, <span class="st">"New Jersey"</span>, <span class="st">"New York"</span>, <span class="st">"Pennsylvania"</span>)</span>
<span id="cb12-4"><a href="http://localhost:4686/#cb12-4" aria-hidden="true" tabindex="-1"></a>great_lakes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Illinois"</span>, <span class="st">"Indiana"</span>, <span class="st">"Michigan"</span>, <span class="st">"Ohio"</span>, <span class="st">"Wisconsin"</span>)</span>
<span id="cb12-5"><a href="http://localhost:4686/#cb12-5" aria-hidden="true" tabindex="-1"></a>plains <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Iowa"</span>, <span class="st">"Kansas"</span>, <span class="st">"Minnesota"</span>, <span class="st">"Missouri"</span>, <span class="st">"Nebraska"</span>, <span class="st">"North Dakota"</span>, <span class="st">"South Dakota"</span>)</span>
<span id="cb12-6"><a href="http://localhost:4686/#cb12-6" aria-hidden="true" tabindex="-1"></a>southeast <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alabama"</span>, <span class="st">"Arkansas"</span>, <span class="st">"Florida"</span>, <span class="st">"Georgia"</span>, <span class="st">"Kentucky"</span>, <span class="st">"Louisiana"</span>, <span class="st">"Mississippi"</span>, <span class="st">"North Carolina"</span>, <span class="st">"South Carolina"</span>, <span class="st">"Tennessee"</span>, <span class="st">"Virginia"</span>, <span class="st">"West Virginia"</span>)</span>
<span id="cb12-7"><a href="http://localhost:4686/#cb12-7" aria-hidden="true" tabindex="-1"></a>southwest <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Arizona"</span>, <span class="st">"New Mexico"</span>, <span class="st">"Oklahoma"</span>, <span class="st">"Texas"</span>)</span>
<span id="cb12-8"><a href="http://localhost:4686/#cb12-8" aria-hidden="true" tabindex="-1"></a>rocky_mountain <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Colorado"</span>, <span class="st">"Idaho"</span>, <span class="st">"Montana"</span>, <span class="st">"Utah"</span>, <span class="st">"Wyoming"</span>)</span>
<span id="cb12-9"><a href="http://localhost:4686/#cb12-9" aria-hidden="true" tabindex="-1"></a>far_west <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Alaska"</span>, <span class="st">"California"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Nevada"</span>, <span class="st">"Oregon"</span>, <span class="st">"Washington"</span>)</span>
<span id="cb12-10"><a href="http://localhost:4686/#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="http://localhost:4686/#cb12-11" aria-hidden="true" tabindex="-1"></a>get_region <span class="ot">&lt;-</span> <span class="cf">function</span>(state) {</span>
<span id="cb12-12"><a href="http://localhost:4686/#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (state <span class="sc">%in%</span> new_england) {</span>
<span id="cb12-13"><a href="http://localhost:4686/#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"New England"</span>)</span>
<span id="cb12-14"><a href="http://localhost:4686/#cb12-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> mideast) {</span>
<span id="cb12-15"><a href="http://localhost:4686/#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Mideast"</span>)</span>
<span id="cb12-16"><a href="http://localhost:4686/#cb12-16" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> great_lakes) {</span>
<span id="cb12-17"><a href="http://localhost:4686/#cb12-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Great Lakes"</span>)</span>
<span id="cb12-18"><a href="http://localhost:4686/#cb12-18" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> plains) {</span>
<span id="cb12-19"><a href="http://localhost:4686/#cb12-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Plains"</span>)</span>
<span id="cb12-20"><a href="http://localhost:4686/#cb12-20" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> southeast) {</span>
<span id="cb12-21"><a href="http://localhost:4686/#cb12-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Southeast"</span>)</span>
<span id="cb12-22"><a href="http://localhost:4686/#cb12-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> southwest) {</span>
<span id="cb12-23"><a href="http://localhost:4686/#cb12-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Southwest"</span>)</span>
<span id="cb12-24"><a href="http://localhost:4686/#cb12-24" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> rocky_mountain) {</span>
<span id="cb12-25"><a href="http://localhost:4686/#cb12-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Rocky Mountain"</span>)</span>
<span id="cb12-26"><a href="http://localhost:4686/#cb12-26" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (state <span class="sc">%in%</span> far_west) {</span>
<span id="cb12-27"><a href="http://localhost:4686/#cb12-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">"Far West"</span>)</span>
<span id="cb12-28"><a href="http://localhost:4686/#cb12-28" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb12-29"><a href="http://localhost:4686/#cb12-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb12-30"><a href="http://localhost:4686/#cb12-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb12-31"><a href="http://localhost:4686/#cb12-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-32"><a href="http://localhost:4686/#cb12-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-33"><a href="http://localhost:4686/#cb12-33" aria-hidden="true" tabindex="-1"></a>imputed_new<span class="sc">$</span>Region <span class="ot">&lt;-</span> <span class="fu">sapply</span>(imputed_new<span class="sc">$</span>State, get_region)</span>
<span id="cb12-34"><a href="http://localhost:4686/#cb12-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-35"><a href="http://localhost:4686/#cb12-35" aria-hidden="true" tabindex="-1"></a>imputed_new<span class="sc">$</span>isSoutheast <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(imputed_new<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">"Southeast"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here is the graph of Lambda values, with the minimum Lambda at 0.18, and the 1 SE Lambda value at 1.767:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="http://localhost:4686/#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Create Lasso Lambda graph</span></span>
<span id="cb13-2"><a href="http://localhost:4686/#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb13-3"><a href="http://localhost:4686/#cb13-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> imputed_new<span class="sc">$</span>TARGET_deathRate</span>
<span id="cb13-4"><a href="http://localhost:4686/#cb13-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">data.matrix</span>(imputed_new[, <span class="fu">c</span>(<span class="st">'povertyPercent'</span>, <span class="st">'PctBlack'</span>, <span class="st">'PctHS18_24'</span>,<span class="st">'PctNoHS18_24'</span>, <span class="st">'isSoutheast'</span>,<span class="st">'PctPublicCoverage'</span>,<span class="st">'PctPublicCoverageAlone'</span>, <span class="st">"PctUnemployed16_Over"</span>)])</span>
<span id="cb13-5"><a href="http://localhost:4686/#cb13-5" aria-hidden="true" tabindex="-1"></a>cv_model <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>)</span>
<span id="cb13-6"><a href="http://localhost:4686/#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./LinearModelingContentV3_files/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="http://localhost:4686/#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Assign 1se lambda and then run Lasso using it</span></span>
<span id="cb14-2"><a href="http://localhost:4686/#cb14-2" aria-hidden="true" tabindex="-1"></a>min_lambda <span class="ot">&lt;-</span> cv_model<span class="sc">$</span>lambda.min</span>
<span id="cb14-3"><a href="http://localhost:4686/#cb14-3" aria-hidden="true" tabindex="-1"></a>se_lambda <span class="ot">&lt;-</span> cv_model<span class="sc">$</span>lambda<span class="fl">.1</span>se</span>
<span id="cb14-4"><a href="http://localhost:4686/#cb14-4" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(x, y, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">lambda =</span> se_lambda)</span>
<span id="cb14-5"><a href="http://localhost:4686/#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(best_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>9 x 1 sparse Matrix of class "dgCMatrix"
                                s0
(Intercept)            124.2552434
povertyPercent           0.4504766
PctBlack                 .        
PctHS18_24               0.3404665
PctNoHS18_24             .        
isSoutheast              9.5552934
PctPublicCoverage        0.1653959
PctPublicCoverageAlone   0.6901461
PctUnemployed16_Over     0.3542458</code></pre>
</div>
</div>
<p>According to the Lasso results, PctBlack and PctNoHS18_24 were eliminated, while PctPublicCoverage, PctPublicCoverageAlone, and PctUnemployed16_Over were admitted. The fit improved somewhat, with an R-squared of 0.287. Interpreting these results, it appears that for this data set, variables related to healthcare coverage and unemployment are better predictors of cancer mortality than the percentage of black residents as well as the percentage of residents 18-24 that have not graduated high school. I don't find this contradictory to prior literature cited that concludes a racial and educational divide in cancer mortality, as not only does Lasso judge on prediction accuracy, but it's more likely that these variables are correlated in some way, and the variables related to healthcare coverage and poverty are more comprehensive due to not segregating by education level or race.&nbsp;</p>
</section>
<section id="coefficient-inference" class="level2">
<h2 class="anchored" data-anchor-id="coefficient-inference">Coefficient Inference<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#coefficient-inference" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>For inference on our coefficient values, I first decided to check normality assumptions using a Q-Q plot before deciding whether or not to conduct inference using a parametric or nonparametric approach.&nbsp;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="http://localhost:4686/#cb16-1" aria-hidden="true" tabindex="-1"></a>finmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> imputed_new, TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctHS18_24 <span class="sc">+</span> isSoutheast <span class="sc">+</span> PctPublicCoverage <span class="sc">+</span> PctPublicCoverageAlone <span class="sc">+</span> PctUnemployed16_Over)</span>
<span id="cb16-2"><a href="http://localhost:4686/#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(finmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = TARGET_deathRate ~ povertyPercent + PctHS18_24 + 
    isSoutheast + PctPublicCoverage + PctPublicCoverageAlone + 
    PctUnemployed16_Over, data = imputed_new)

Residuals:
     Min       1Q   Median       3Q      Max 
-110.107  -13.052    1.293   14.243  163.409 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            122.3032     2.4841  49.234  &lt; 2e-16 ***
povertyPercent           0.5638     0.1207   4.672 3.12e-06 ***
PctHS18_24               0.4931     0.0497   9.922  &lt; 2e-16 ***
isSoutheastYes          11.6651     1.0157  11.485  &lt; 2e-16 ***
PctPublicCoverage        0.2811     0.1109   2.535  0.01128 *  
PctPublicCoverageAlone   0.5704     0.1827   3.123  0.00181 ** 
PctUnemployed16_Over     0.5630     0.1730   3.253  0.00115 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 23.46 on 3040 degrees of freedom
Multiple R-squared:  0.2866,    Adjusted R-squared:  0.2852 
F-statistic: 203.5 on 6 and 3040 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Here is the Q-Q plot:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="http://localhost:4686/#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(finmod, <span class="at">which =</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./LinearModelingContentV3_files/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>While the line appears to fit well towards the center of the plot, the line veers off heavily towards the ends. For greater inference, I decided to use a Shapiro-Wilk hypothesis test on the residual values to test for normality, resulting in a p-value coming out to &lt;2e-16, thus rejecting the null hypothesis that our fitted results are normal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="http://localhost:4686/#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(finmod<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  finmod$residuals
W = 0.98178, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<p>For inference, I thus chose to use a Bootstrap algorithm to understand the sampling distribution of our coefficients, and develop a confidence interval to use in the interpretation of our final model. Additionally, using a percentile confidence interval from these sampling distributions, I then tested the null hypothesis that each variable’s value is actually 0. Since I would thus be performing 6 hypothesis tests, I applied a Bonferroni correction to my significance level of 0.05, thus making the confidence interval from the 0.004166667 quantile to the 0.9958333 quantile. Note that applying this Bonferroni correction results in a significantly larger confidence interval than if not applied, as the original confidence interval would thus be from the 0.025 quantile to the 0.975 quantile.&nbsp;</p>
<p>Here is a figure of all the bootstrapped sampling distributions (10000 replications), along with the confidence intervals and original coefficient estimates marked on the graph:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="http://localhost:4686/#cb21-1" aria-hidden="true" tabindex="-1"></a>nboot <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-2"><a href="http://localhost:4686/#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-3"><a href="http://localhost:4686/#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="http://localhost:4686/#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to calculate the coefficients using the bootstrap</span></span>
<span id="cb21-5"><a href="http://localhost:4686/#cb21-5" aria-hidden="true" tabindex="-1"></a>coef.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb21-6"><a href="http://localhost:4686/#cb21-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctHS18_24 <span class="sc">+</span> isSoutheast <span class="sc">+</span> PctPublicCoverage <span class="sc">+</span> PctPublicCoverageAlone <span class="sc">+</span> PctUnemployed16_Over, <span class="at">data =</span> data[indices, ])</span>
<span id="cb21-7"><a href="http://localhost:4686/#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(model)[<span class="sc">-</span><span class="dv">1</span>]) <span class="co"># exclude intercept column</span></span>
<span id="cb21-8"><a href="http://localhost:4686/#cb21-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-9"><a href="http://localhost:4686/#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="http://localhost:4686/#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the bootstrap using the defined function</span></span>
<span id="cb21-11"><a href="http://localhost:4686/#cb21-11" aria-hidden="true" tabindex="-1"></a>boot.results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> imputed_new, <span class="at">statistic =</span> coef.boot, <span class="at">R =</span> nboot)</span>
<span id="cb21-12"><a href="http://localhost:4686/#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="http://localhost:4686/#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert bootstrap results to a data frame</span></span>
<span id="cb21-14"><a href="http://localhost:4686/#cb21-14" aria-hidden="true" tabindex="-1"></a>boot.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(boot.results<span class="sc">$</span>t)</span>
<span id="cb21-15"><a href="http://localhost:4686/#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(boot.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"povertyPercent"</span>, <span class="st">"PctHS18_24"</span>, <span class="st">"isSoutheastYes"</span>,<span class="st">"PctPublicCoverage"</span>, <span class="st">"PctPublicCoverageAlone"</span>, <span class="st">"PctUnemployed16_Over"</span>)</span>
<span id="cb21-16"><a href="http://localhost:4686/#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="http://localhost:4686/#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficient estimates from original model</span></span>
<span id="cb21-18"><a href="http://localhost:4686/#cb21-18" aria-hidden="true" tabindex="-1"></a>finmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctHS18_24 <span class="sc">+</span> isSoutheast <span class="sc">+</span> PctPublicCoverage <span class="sc">+</span> PctPublicCoverageAlone <span class="sc">+</span> PctUnemployed16_Over, <span class="at">data =</span> imputed_new)</span>
<span id="cb21-19"><a href="http://localhost:4686/#cb21-19" aria-hidden="true" tabindex="-1"></a>coef.estimates <span class="ot">&lt;-</span> <span class="fu">coef</span>(finmod)[<span class="sc">-</span><span class="dv">1</span> , drop <span class="ot">=</span> <span class="cn">TRUE</span>]</span>
<span id="cb21-20"><a href="http://localhost:4686/#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="http://localhost:4686/#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot histograms with quantile and coefficient lines and a title</span></span>
<span id="cb21-22"><a href="http://localhost:4686/#cb21-22" aria-hidden="true" tabindex="-1"></a>plot.hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, coef.est, varname) {</span>
<span id="cb21-23"><a href="http://localhost:4686/#cb21-23" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb21-24"><a href="http://localhost:4686/#cb21-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="http://localhost:4686/#cb21-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>)), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-26"><a href="http://localhost:4686/#cb21-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> coef.est, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb21-27"><a href="http://localhost:4686/#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb21-28"><a href="http://localhost:4686/#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(varname)<span class="sc">+</span></span>
<span id="cb21-29"><a href="http://localhost:4686/#cb21-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">9.5</span>))</span>
<span id="cb21-30"><a href="http://localhost:4686/#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb21-31"><a href="http://localhost:4686/#cb21-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-32"><a href="http://localhost:4686/#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="http://localhost:4686/#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of plots for each column in boot.df with titles</span></span>
<span id="cb21-34"><a href="http://localhost:4686/#cb21-34" aria-hidden="true" tabindex="-1"></a>plot.list <span class="ot">&lt;-</span> <span class="fu">mapply</span>(plot.hist, <span class="at">x =</span> boot.df, <span class="at">coef.est =</span> coef.estimates, <span class="at">varname =</span> <span class="fu">names</span>(boot.df), <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-35"><a href="http://localhost:4686/#cb21-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-36"><a href="http://localhost:4686/#cb21-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots into a single figure with a title</span></span>
<span id="cb21-37"><a href="http://localhost:4686/#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot.list, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">top =</span> <span class="fu">textGrob</span>(<span class="st">'Histograms of Coefficient Estimates with 95% Confidence Intervals </span><span class="sc">\n</span><span class="st"> using a Bonferroni Correction for 6 Tests'</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">13</span>, <span class="at">fontface =</span> <span class="dv">2</span>))</span>
<span id="cb21-38"><a href="http://localhost:4686/#cb21-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./LinearModelingContentV3_files/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From initial inspection, it's clear that povertyPercent, PctHS18_24, and isSoutheastYes all reject the null hypothesis that the respective coefficient effect is actually 0. Upon inspecting PctUnemployed16_Over's bottom quantile, (0.01195514), it appears this variable as well rejects the null hypothesis that the respective coefficient effect is actually 0. PctPublicCoverage and PctPublicCoverageAlone both fail to reject the hypothesis that the coefficient effect is actually 0. Based on these inference results, each of the variables with a confidence interval that doesn't include 0 does have some effect on cancer mortality, while we cannot for certain say the same for PctPublicCoverage and PctPublicCoverageAlone, whose confidence interval does contain 0. These conclusions of course are contingent on confidence level selected (0.05 with a Bonferroni Correction), the randomness of the Bootstrap (10000 replications), as well as the randomness of the imputation process.&nbsp;</p>
<p>Before variable interpretation, I investigated the assumption of MAR (Missing at Random), using the same bootstrap procedure discussed previously. If indeed the data imputed is MAR, the reduced data set bootstrap sampling distribution should look similar, or hopefully the same as the imputed data set bootstrap sampling distributions. Since only one of the variables with NA values was used in the final model, PctPrivateCoverageAlone, I only removed rows that have an NA in this variable, instead of all rows with an NA. Comparing the reduced data set to the imputed data set, the reduced data set lost 609 observations. I then ran the same bootstrap procedure as before, and then overlap the sampling distributions for each data set:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="http://localhost:4686/#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create reduced data set and apply the Southeast column used previously</span></span>
<span id="cb22-2"><a href="http://localhost:4686/#cb22-2" aria-hidden="true" tabindex="-1"></a>reduced <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(trim[,<span class="sc">-</span><span class="dv">21</span>])</span>
<span id="cb22-3"><a href="http://localhost:4686/#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(reduced) <span class="sc">-</span> <span class="fu">nrow</span>(imputed_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -609</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="http://localhost:4686/#cb24-1" aria-hidden="true" tabindex="-1"></a>reduced<span class="sc">$</span>Region <span class="ot">&lt;-</span> <span class="fu">sapply</span>(reduced<span class="sc">$</span>State, get_region)</span>
<span id="cb24-2"><a href="http://localhost:4686/#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="http://localhost:4686/#cb24-3" aria-hidden="true" tabindex="-1"></a>reduced<span class="sc">$</span>isSoutheast <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(reduced<span class="sc">$</span>Region <span class="sc">==</span> <span class="st">"Southeast"</span>, <span class="st">"Yes"</span>, <span class="st">"No"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="http://localhost:4686/#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb25-2"><a href="http://localhost:4686/#cb25-2" aria-hidden="true" tabindex="-1"></a>nboot <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb25-3"><a href="http://localhost:4686/#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="http://localhost:4686/#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to calculate the coefficients using the bootstrap</span></span>
<span id="cb25-5"><a href="http://localhost:4686/#cb25-5" aria-hidden="true" tabindex="-1"></a>coef.boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb25-6"><a href="http://localhost:4686/#cb25-6" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctHS18_24 <span class="sc">+</span> isSoutheast <span class="sc">+</span> PctPublicCoverage <span class="sc">+</span> PctPublicCoverageAlone <span class="sc">+</span> PctUnemployed16_Over, <span class="at">data =</span> data[indices, ])</span>
<span id="cb25-7"><a href="http://localhost:4686/#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">coef</span>(model)[<span class="sc">-</span><span class="dv">1</span>]) <span class="co"># exclude intercept column</span></span>
<span id="cb25-8"><a href="http://localhost:4686/#cb25-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-9"><a href="http://localhost:4686/#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="http://localhost:4686/#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the bootstrap using the defined function</span></span>
<span id="cb25-11"><a href="http://localhost:4686/#cb25-11" aria-hidden="true" tabindex="-1"></a>boot.results.reduce <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> reduced, <span class="at">statistic =</span> coef.boot, <span class="at">R =</span> nboot)</span>
<span id="cb25-12"><a href="http://localhost:4686/#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="http://localhost:4686/#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert bootstrap results to a data frame</span></span>
<span id="cb25-14"><a href="http://localhost:4686/#cb25-14" aria-hidden="true" tabindex="-1"></a>boot.df.reduce <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(boot.results.reduce<span class="sc">$</span>t)</span>
<span id="cb25-15"><a href="http://localhost:4686/#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(boot.df.reduce) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"povertyPercent"</span>, <span class="st">"PctHS18_24"</span>, <span class="st">"isSoutheastYes"</span>,<span class="st">"PctPublicCoverage"</span>, <span class="st">"PctPublicCoverageAlone"</span>, <span class="st">"PctUnemployed16_Over"</span>)</span>
<span id="cb25-16"><a href="http://localhost:4686/#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="http://localhost:4686/#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Get coefficient estimates from original model</span></span>
<span id="cb25-18"><a href="http://localhost:4686/#cb25-18" aria-hidden="true" tabindex="-1"></a>finmod.reduce <span class="ot">&lt;-</span> <span class="fu">lm</span>(TARGET_deathRate <span class="sc">~</span> povertyPercent <span class="sc">+</span> PctHS18_24 <span class="sc">+</span> isSoutheast <span class="sc">+</span> PctPublicCoverage <span class="sc">+</span> PctPublicCoverageAlone <span class="sc">+</span> PctUnemployed16_Over, <span class="at">data =</span> reduced)</span>
<span id="cb25-19"><a href="http://localhost:4686/#cb25-19" aria-hidden="true" tabindex="-1"></a>coef.estimates.reduce <span class="ot">&lt;-</span> <span class="fu">coef</span>(finmod.reduce)[<span class="sc">-</span><span class="dv">1</span> , drop <span class="ot">=</span> <span class="cn">TRUE</span>]</span>
<span id="cb25-20"><a href="http://localhost:4686/#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="http://localhost:4686/#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot histograms with quantile and coefficient lines and a title</span></span>
<span id="cb25-22"><a href="http://localhost:4686/#cb25-22" aria-hidden="true" tabindex="-1"></a>plot.hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, coef.est, varname) {</span>
<span id="cb25-23"><a href="http://localhost:4686/#cb25-23" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb25-24"><a href="http://localhost:4686/#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb25-25"><a href="http://localhost:4686/#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>)), <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb25-26"><a href="http://localhost:4686/#cb25-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> coef.est, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb25-27"><a href="http://localhost:4686/#cb25-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb25-28"><a href="http://localhost:4686/#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(varname)<span class="sc">+</span></span>
<span id="cb25-29"><a href="http://localhost:4686/#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">9.5</span>))</span>
<span id="cb25-30"><a href="http://localhost:4686/#cb25-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb25-31"><a href="http://localhost:4686/#cb25-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-32"><a href="http://localhost:4686/#cb25-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-33"><a href="http://localhost:4686/#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of plots for each column in boot.df with titles</span></span>
<span id="cb25-34"><a href="http://localhost:4686/#cb25-34" aria-hidden="true" tabindex="-1"></a>plot.list <span class="ot">&lt;-</span> <span class="fu">mapply</span>(plot.hist, <span class="at">x =</span> boot.df.reduce, <span class="at">coef.est =</span> coef.estimates.reduce, <span class="at">varname =</span> <span class="fu">names</span>(boot.df.reduce), <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb25-35"><a href="http://localhost:4686/#cb25-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-36"><a href="http://localhost:4686/#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the plots into a single figure with a title</span></span>
<span id="cb25-37"><a href="http://localhost:4686/#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot.list, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">top =</span> <span class="fu">textGrob</span>(<span class="st">'Reduced Data Histograms of Coefficient Estimates with 95% Confidence Intervals'</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">13</span>, <span class="at">fontface =</span> <span class="dv">2</span>))</span>
<span id="cb25-38"><a href="http://localhost:4686/#cb25-38" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./LinearModelingContentV3_files/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="http://localhost:4686/#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine the two bootstrapped data frames</span></span>
<span id="cb26-2"><a href="http://localhost:4686/#cb26-2" aria-hidden="true" tabindex="-1"></a>boot.df_combined <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb26-3"><a href="http://localhost:4686/#cb26-3" aria-hidden="true" tabindex="-1"></a>  boot.df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"Original"</span>),</span>
<span id="cb26-4"><a href="http://localhost:4686/#cb26-4" aria-hidden="true" tabindex="-1"></a>  boot.df.reduce <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">group =</span> <span class="st">"Reduced"</span>)</span>
<span id="cb26-5"><a href="http://localhost:4686/#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="http://localhost:4686/#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="http://localhost:4686/#cb26-7" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">=</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(boot.df_combined)</span>
<span id="cb26-8"><a href="http://localhost:4686/#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="http://localhost:4686/#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a function to plot histograms with quantile and coefficient lines and a title</span></span>
<span id="cb26-10"><a href="http://localhost:4686/#cb26-10" aria-hidden="true" tabindex="-1"></a>plot.hist <span class="ot">&lt;-</span> <span class="cf">function</span>(x, coef.est, coef.est.reduce, varname) {</span>
<span id="cb26-11"><a href="http://localhost:4686/#cb26-11" aria-hidden="true" tabindex="-1"></a>  group <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(idx <span class="sc">&lt;=</span> <span class="fu">nrow</span>(boot.df), <span class="st">"Original"</span>, <span class="st">"Reduced"</span>)</span>
<span id="cb26-12"><a href="http://localhost:4686/#cb26-12" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(x, <span class="at">group =</span> group), <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb26-13"><a href="http://localhost:4686/#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="fu">aes</span>(<span class="at">fill =</span> group), <span class="at">position =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb26-14"><a href="http://localhost:4686/#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> coef.est, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb26-15"><a href="http://localhost:4686/#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> coef.est.reduce, <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb26-16"><a href="http://localhost:4686/#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb26-17"><a href="http://localhost:4686/#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(varname) <span class="sc">+</span></span>
<span id="cb26-18"><a href="http://localhost:4686/#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="fl">9.5</span>)) <span class="sc">+</span></span>
<span id="cb26-19"><a href="http://localhost:4686/#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Original"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"Reduced"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb26-20"><a href="http://localhost:4686/#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb26-21"><a href="http://localhost:4686/#cb26-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-22"><a href="http://localhost:4686/#cb26-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-23"><a href="http://localhost:4686/#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a list of plots for each column in boot.df with titles</span></span>
<span id="cb26-24"><a href="http://localhost:4686/#cb26-24" aria-hidden="true" tabindex="-1"></a>plot.list <span class="ot">&lt;-</span> <span class="fu">mapply</span>(plot.hist, <span class="at">x =</span> boot.df_combined[,<span class="sc">-</span><span class="dv">7</span>], <span class="at">coef.est =</span> coef.estimates, <span class="at">coef.est.reduce =</span> coef.estimates.reduce, <span class="at">varname =</span> <span class="fu">names</span>(boot.df_combined)[<span class="sc">-</span><span class="dv">7</span>], <span class="at">SIMPLIFY =</span> <span class="cn">FALSE</span>)</span>
<span id="cb26-25"><a href="http://localhost:4686/#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="http://localhost:4686/#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(<span class="at">grobs =</span> plot.list, <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">top =</span> <span class="fu">textGrob</span>(<span class="st">'Overlayed Histograms of Coefficient Estimates, </span><span class="sc">\n</span><span class="st">Blue is reduced data, Red is imputed data'</span>, <span class="at">gp=</span><span class="fu">gpar</span>(<span class="at">fontsize=</span><span class="dv">13</span>, <span class="at">fontface =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="./LinearModelingContentV3_files/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As seen in the graphs, the reduced data set bootstrap distributions are extremely similar to the imputed data set bootstrap distributions, helping confirm the assumption that the data is MAR (Missing at Random) and not biasing the estimates. Additionally, the coefficient estimates for the reduced and imputed data sets are almost the same, deviating less than 0.2 for every variable.&nbsp;</p>
</section>
<section id="variable-interpretationconclusion" class="level2">
<h2 class="anchored" data-anchor-id="variable-interpretationconclusion">Variable Interpretation/Conclusion<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#variable-interpretationconclusion" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Here is the summary of my final model after variable selection:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="http://localhost:4686/#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(finmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = TARGET_deathRate ~ povertyPercent + PctHS18_24 + 
    isSoutheast + PctPublicCoverage + PctPublicCoverageAlone + 
    PctUnemployed16_Over, data = imputed_new)

Residuals:
     Min       1Q   Median       3Q      Max 
-110.107  -13.052    1.293   14.243  163.409 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            122.3032     2.4841  49.234  &lt; 2e-16 ***
povertyPercent           0.5638     0.1207   4.672 3.12e-06 ***
PctHS18_24               0.4931     0.0497   9.922  &lt; 2e-16 ***
isSoutheastYes          11.6651     1.0157  11.485  &lt; 2e-16 ***
PctPublicCoverage        0.2811     0.1109   2.535  0.01128 *  
PctPublicCoverageAlone   0.5704     0.1827   3.123  0.00181 ** 
PctUnemployed16_Over     0.5630     0.1730   3.253  0.00115 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 23.46 on 3040 degrees of freedom
Multiple R-squared:  0.2866,    Adjusted R-squared:  0.2852 
F-statistic: 203.5 on 6 and 3040 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="http://localhost:4686/#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>povertyPercent, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.4166667%  99.58333% 
 0.2000268  0.9466988 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="http://localhost:4686/#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>PctHS18_24, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.4166667%  99.58333% 
 0.3419795  0.6497332 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="http://localhost:4686/#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>isSoutheastYes, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.4166667%  99.58333% 
  8.642598  14.666479 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="http://localhost:4686/#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>PctPublicCoverage, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 0.4166667%   99.58333% 
-0.06139477  0.62534342 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="http://localhost:4686/#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>PctPublicCoverageAlone, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  0.4166667%    99.58333% 
-0.006147866  1.162750944 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="http://localhost:4686/#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(boot.df<span class="sc">$</span>PctUnemployed16_Over, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.004166667</span>, <span class="fl">0.9958333</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.4166667%  99.58333% 
0.01195514 1.11447750 </code></pre>
</div>
</div>
<p>Based on the results of my modeling using Lasso regression and Bootstrap inference, I came to the following conclusions to my research question. For every percent increase of a county’s population in poverty, on average the cancer mortality per 100,000 residents in a county increases by approximately 0.563 individuals (CI: 0.2000-0.9467). For every percent increase of county residents ages 18-24 who's highest education attained is a high school diploma, on average the cancer mortality per 100,000 residents increases by 0.4931 (CI: 0.3419-0.6497). Compared to other regions of the United States, Southeast countries have on average 11.66 (CI: 8.642-14.6664) more cancer deaths per 100,000 residents. For every percent increase of county residents with government-provided health coverage, on average the cancer mortality per 100,000 residents in a county increases by approximately 0.2811 individuals (CI: -0.06139-0.6253). For every percent increase of county residents with government-provided health coverage alone, on average the cancer mortality per 100,000 residents in a county increases by approximately 0.5704 individuals (CI: -0.00614-1.1627). Finally, for every percent increase of county residents ages 16 and over unemployed, on average the cancer mortality per 100,000 residents in a county increases by approximately 0.563 individuals (CI: 0.0119-1.1144).</p>
<p>From these conclusions, the most important finding is that counties in the Southeast region of the United States have significantly higher cancer mortality than other regions of the United States. It is important to note that these conclusions have some limitations, including the fact that the data ends at 2016 and only includes deaths from lung cancer, and that the modeling assumes no excessive collinearity and utilizes techniques such as Lasso or Bootstrapping, which have an aspect of randomness. Regardless, from these conclusions I would suggest further research on specifically the Southeast region of the United States, to better understand the specific causes of such higher mortality rates. Additionally, based on the results, education and poverty were identified as significant predictors of cancer mortality, suggesting a few areas of focus to start research on. Overall, the results highlight the need for federal action to aid these Southeast communities, which in turn will reduce cancer mortality overall in the United States.</p>
</section>
<section id="data-citation" class="level2">
<h2 class="anchored" data-anchor-id="data-citation">Data Citation<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#data-citation" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>N.Rippner. Cancer Trials, 2017. Retrieved from http://data.world/exercises/</p>
<p>linear-regression-exercise-1/workspace/file?filename=cancer_reg.csv.</p>
<p><br>
</p>
</section>
<section id="sources-cited" class="level2">
<h2 class="anchored" data-anchor-id="sources-cited">Sources Cited<a class="anchorjs-link " aria-label="Anchor" data-anchorjs-icon="" href="http://localhost:4686/#sources-cited" style="font: 1em / 1 anchorjs-icons; padding-left: 0.375em;"></a></h2>
<p>Singh, G. K., &amp; Jemal, A. (2017). Socioeconomic and Racial/Ethnic Disparities in Cancer Mortality, Incidence, and Survival in the United States, 1950-2014: Over Six Decades of Changing Patterns and Widening Inequalities. Journal of environmental and public health, 2017, 2819372. <a href="https://doi.org/10.1155/2017/2819372" class="uri">https://doi.org/10.1155/2017/2819372</a></p>
<p>U.S. Bureau of Economic Analysis. (n.d.). Regional economic accounts. Iowa State University.<a href="https://www.icip.iastate.edu/maps/refmaps/bea">https://www.icip.iastate.edu/maps/refmaps/bea</a></p>
<p>Withrow, D. R., Freedman, N. D., Gibson, J. T., Yu, M., Nápoles, A. M., Berrington de González, A., &amp; Shiels, M. S. (2021). Leading cancers contributing to educational disparities in cancer mortality in the US, 2017. Cancer causes &amp; control : CCC, 32(11), 1193–1196. <a href="https://doi.org/10.1007/s10552-021-01471-9" class="uri">https://doi.org/10.1007/s10552-021-01471-9</a></p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<div class="modal__dialog micromodal-slide" id="quarto-log-error-modal" aria-hidden="true">
  <div class="modal__overlay" tabindex="2" data-micromodal-close="">
    <div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="quarto-log-error-modal-title">
      <header class="modal__header">
        <h2 class="modal__title" id="quarto-log-error-modal-title">
          <i class="bi bi-exclamation-circle"></i>Error
        </h2>
        <button class="modal__close" aria-label="Close modal" data-micromodal-close=""></button>
      </header>
      <div class="modal__content" id="quarto-log-error-modal-content">
        <pre tabindex="1" id="quarto-log-error-display"></pre>
      </div>
      <footer class="modal__footer">
      </footer>
    </div>
  </div>
</div>
<style type="text/css">
#quarto-log-error-modal .modal__overlay {
  z-index: 5000;
}
#quarto-log-error-modal-content {
  border: 1px solid #dee2e6;
  overflow-y: auto;
}
#quarto-log-error-display {
  min-height: 100px;
  padding: 8px;
  margin-bottom: 0;
  font-family: monospace;
}
#quarto-log-error-display:focus {
  outline: none;
}
.modal__dialog {
  font-size: 16px;
}
.modal__overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.4);
  display: flex;
  justify-content: center;
  align-items: center;
}
.modal__container {
  position: fixed;
  top: 80px;
  background-color: #fff;
  padding: 15px;
  padding-top: 10px;
  min-width: 500px;
  max-width: 90%;
  max-height: 90vh;
  border-radius: 4px;
  overflow-y: auto;
  box-sizing: border-box;
}
.modal__header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.modal__title {
  margin-top: 0;
  margin-bottom: 0;
  font-weight: 600;
  border-bottom: none;
  padding-bottom: 10px;
  font-size: 20px;
  color: rgb(191,71,65);
  line-height: 1.25;
  box-sizing: border-box;
}
.modal__title .bi {
  margin-right: 7px;
}
.modal__close {
  background: transparent;
  border: 0;
  margin-bottom: 10px;
}
.modal__header .modal__close:before { content: "\2715"; }
.modal__content {
  margin-top: 0;
  margin-bottom: 0;
}
@keyframes mmfadeIn {
    from { opacity: 0; }
      to { opacity: 1; }
}
@keyframes mmfadeOut {
    from { opacity: 1; }
      to { opacity: 0; }
}
@keyframes mmslideIn {
  from { transform: translateY(15%); }
    to { transform: translateY(0); }
}
@keyframes mmslideOut {
    from { transform: translateY(0); }
    to { transform: translateY(-10%); }
}
.micromodal-slide {
  display: none;
}
.micromodal-slide.is-open {
  display: block;
}
.micromodal-slide[aria-hidden="false"] .modal__overlay {
  animation: mmfadeIn .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="false"] .modal__container {
  animation: mmslideIn .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__overlay {
  animation: mmfadeOut .3s cubic-bezier(0.0, 0.0, 0.2, 1);
}
.micromodal-slide[aria-hidden="true"] .modal__container {
  animation: mmslideOut .3s cubic-bezier(0, 0, .2, 1);
}
.micromodal-slide .modal__container,
.micromodal-slide .modal__overlay {
  will-change: transform;
} 
</style>
<script type="text/javascript">
  window.backupDefine = window.define; window.define = undefined;
  /*  ansi_up.js
   *  author : Dru Nelson
   *  license : MIT
   *  http://github.com/drudru/ansi_up
   */
   (function (root, factory) {
      if (typeof define === 'function' && define.amd) {
          // AMD. Register as an anonymous module.
          define(['exports'], factory);
      } else if (typeof exports === 'object' && typeof exports.nodeName !== 'string') {
          // CommonJS
          factory(exports);
      } else {
          // Browser globals
          var exp = {};
          factory(exp);
          root.AnsiUp = exp.default;
      }
  }(this, function (exports) {
  "use strict";
  var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
      if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
      return cooked;
  };
  var PacketKind;
  (function (PacketKind) {
      PacketKind[PacketKind["EOS"] = 0] = "EOS";
      PacketKind[PacketKind["Text"] = 1] = "Text";
      PacketKind[PacketKind["Incomplete"] = 2] = "Incomplete";
      PacketKind[PacketKind["ESC"] = 3] = "ESC";
      PacketKind[PacketKind["Unknown"] = 4] = "Unknown";
      PacketKind[PacketKind["SGR"] = 5] = "SGR";
      PacketKind[PacketKind["OSCURL"] = 6] = "OSCURL";
  })(PacketKind || (PacketKind = {}));
  var AnsiUp = (function () {
      function AnsiUp() {
          this.VERSION = "5.1.0";
          this.setup_palettes();
          this._use_classes = false;
          this.bold = false;
          this.italic = false;
          this.underline = false;
          this.fg = this.bg = null;
          this._buffer = '';
          this._url_whitelist = { 'http': 1, 'https': 1 };
      }
      Object.defineProperty(AnsiUp.prototype, "use_classes", {
          get: function () {
              return this._use_classes;
          },
          set: function (arg) {
              this._use_classes = arg;
          },
          enumerable: false,
          configurable: true
      });
      Object.defineProperty(AnsiUp.prototype, "url_whitelist", {
          get: function () {
              return this._url_whitelist;
          },
          set: function (arg) {
              this._url_whitelist = arg;
          },
          enumerable: false,
          configurable: true
      });
      AnsiUp.prototype.setup_palettes = function () {
          var _this = this;
          this.ansi_colors =
              [
                  [
                      { rgb: [0, 0, 0], class_name: "ansi-black" },
                      { rgb: [187, 0, 0], class_name: "ansi-red" },
                      { rgb: [0, 187, 0], class_name: "ansi-green" },
                      { rgb: [187, 187, 0], class_name: "ansi-yellow" },
                      { rgb: [0, 0, 187], class_name: "ansi-blue" },
                      { rgb: [187, 0, 187], class_name: "ansi-magenta" },
                      { rgb: [0, 187, 187], class_name: "ansi-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-white" }
                  ],
                  [
                      { rgb: [85, 85, 85], class_name: "ansi-bright-black" },
                      { rgb: [255, 85, 85], class_name: "ansi-bright-red" },
                      { rgb: [0, 255, 0], class_name: "ansi-bright-green" },
                      { rgb: [255, 255, 85], class_name: "ansi-bright-yellow" },
                      { rgb: [85, 85, 255], class_name: "ansi-bright-blue" },
                      { rgb: [255, 85, 255], class_name: "ansi-bright-magenta" },
                      { rgb: [85, 255, 255], class_name: "ansi-bright-cyan" },
                      { rgb: [255, 255, 255], class_name: "ansi-bright-white" }
                  ]
              ];
          this.palette_256 = [];
          this.ansi_colors.forEach(function (palette) {
              palette.forEach(function (rec) {
                  _this.palette_256.push(rec);
              });
          });
          var levels = [0, 95, 135, 175, 215, 255];
          for (var r = 0; r < 6; ++r) {
              for (var g = 0; g < 6; ++g) {
                  for (var b = 0; b < 6; ++b) {
                      var col = { rgb: [levels[r], levels[g], levels[b]], class_name: 'truecolor' };
                      this.palette_256.push(col);
                  }
              }
          }
          var grey_level = 8;
          for (var i = 0; i < 24; ++i, grey_level += 10) {
              var gry = { rgb: [grey_level, grey_level, grey_level], class_name: 'truecolor' };
              this.palette_256.push(gry);
          }
      };
      AnsiUp.prototype.escape_txt_for_html = function (txt) {
          return txt.replace(/[&<>"']/gm, function (str) {
              if (str === "&")
                  return "&amp;";
              if (str === "<")
                  return "&lt;";
              if (str === ">")
                  return "&gt;";
              if (str === "\"")
                  return "&quot;";
              if (str === "'")
                  return "&#x27;";
          });
      };
      AnsiUp.prototype.append_buffer = function (txt) {
          var str = this._buffer + txt;
          this._buffer = str;
      };
      AnsiUp.prototype.get_next_packet = function () {
          var pkt = {
              kind: PacketKind.EOS,
              text: '',
              url: ''
          };
          var len = this._buffer.length;
          if (len == 0)
              return pkt;
          var pos = this._buffer.indexOf("\x1B");
          if (pos == -1) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer;
              this._buffer = '';
              return pkt;
          }
          if (pos > 0) {
              pkt.kind = PacketKind.Text;
              pkt.text = this._buffer.slice(0, pos);
              this._buffer = this._buffer.slice(pos);
              return pkt;
          }
          if (pos == 0) {
              if (len == 1) {
                  pkt.kind = PacketKind.Incomplete;
                  return pkt;
              }
              var next_char = this._buffer.charAt(1);
              if ((next_char != '[') && (next_char != ']')) {
                  pkt.kind = PacketKind.ESC;
                  pkt.text = this._buffer.slice(0, 1);
                  this._buffer = this._buffer.slice(1);
                  return pkt;
              }
              if (next_char == '[') {
                  if (!this._csi_regex) {
                      this._csi_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \u001B[                      # CSI\n                          ([<-?]?)              # private-mode char\n                          ([d;]*)                    # any digits or semicolons\n                          ([ -/]?               # an intermediate modifier\n                          [@-~])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \u001B[                      # CSI\n                          [ -~]*                # anything legal\n                          ([\0-\u001F:])              # anything illegal\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                                                    # First attempt\n                        (?:                         # legal sequence\n                          \\x1b\\[                      # CSI\n                          ([\\x3c-\\x3f]?)              # private-mode char\n                          ([\\d;]*)                    # any digits or semicolons\n                          ([\\x20-\\x2f]?               # an intermediate modifier\n                          [\\x40-\\x7e])                # the command\n                        )\n                        |                           # alternate (second attempt)\n                        (?:                         # illegal sequence\n                          \\x1b\\[                      # CSI\n                          [\\x20-\\x7e]*                # anything legal\n                          ([\\x00-\\x1f:])              # anything illegal\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._csi_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if (match[4]) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if ((match[1] != '') || (match[3] != 'm'))
                      pkt.kind = PacketKind.Unknown;
                  else
                      pkt.kind = PacketKind.SGR;
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
              if (next_char == ']') {
                  if (len < 4) {
                      pkt.kind = PacketKind.Incomplete;
                      return pkt;
                  }
                  if ((this._buffer.charAt(2) != '8')
                      || (this._buffer.charAt(3) != ';')) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  if (!this._osc_st) {
                      this._osc_st = rgxG(__makeTemplateObject(["\n                        (?:                         # legal sequence\n                          (\u001B\\)                    # ESC                           |                           # alternate\n                          (\u0007)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\0-\u0006]                 # anything illegal\n                          |                           # alternate\n                          [\b-\u001A]                 # anything illegal\n                          |                           # alternate\n                          [\u001C-\u001F]                 # anything illegal\n                        )\n                    "], ["\n                        (?:                         # legal sequence\n                          (\\x1b\\\\)                    # ESC \\\n                          |                           # alternate\n                          (\\x07)                      # BEL (what xterm did)\n                        )\n                        |                           # alternate (second attempt)\n                        (                           # illegal sequence\n                          [\\x00-\\x06]                 # anything illegal\n                          |                           # alternate\n                          [\\x08-\\x1a]                 # anything illegal\n                          |                           # alternate\n                          [\\x1c-\\x1f]                 # anything illegal\n                        )\n                    "]));
                  }
                  this._osc_st.lastIndex = 0;
                  {
                      var match_1 = this._osc_st.exec(this._buffer);
                      if (match_1 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_1[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  {
                      var match_2 = this._osc_st.exec(this._buffer);
                      if (match_2 === null) {
                          pkt.kind = PacketKind.Incomplete;
                          return pkt;
                      }
                      if (match_2[3]) {
                          pkt.kind = PacketKind.ESC;
                          pkt.text = this._buffer.slice(0, 1);
                          this._buffer = this._buffer.slice(1);
                          return pkt;
                      }
                  }
                  if (!this._osc_regex) {
                      this._osc_regex = rgx(__makeTemplateObject(["\n                        ^                           # beginning of line\n                                                    #\n                        \u001B]8;                    # OSC Hyperlink\n                        [ -:<-~]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([!-~]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                        ([ -~]+)              # TEXT capture\n                        \u001B]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\u001B\\)                  # ESC                           |                           # alternate\n                          (?:\u0007)                    # BEL (what xterm did)\n                        )\n                    "], ["\n                        ^                           # beginning of line\n                                                    #\n                        \\x1b\\]8;                    # OSC Hyperlink\n                        [\\x20-\\x3a\\x3c-\\x7e]*       # params (excluding ;)\n                        ;                           # end of params\n                        ([\\x21-\\x7e]{0,512})        # URL capture\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                        ([\\x20-\\x7e]+)              # TEXT capture\n                        \\x1b\\]8;;                   # OSC Hyperlink End\n                        (?:                         # ST\n                          (?:\\x1b\\\\)                  # ESC \\\n                          |                           # alternate\n                          (?:\\x07)                    # BEL (what xterm did)\n                        )\n                    "]));
                  }
                  var match = this._buffer.match(this._osc_regex);
                  if (match === null) {
                      pkt.kind = PacketKind.ESC;
                      pkt.text = this._buffer.slice(0, 1);
                      this._buffer = this._buffer.slice(1);
                      return pkt;
                  }
                  pkt.kind = PacketKind.OSCURL;
                  pkt.url = match[1];
                  pkt.text = match[2];
                  var rpos = match[0].length;
                  this._buffer = this._buffer.slice(rpos);
                  return pkt;
              }
          }
      };
      AnsiUp.prototype.ansi_to_html = function (txt) {
          this.append_buffer(txt);
          var blocks = [];
          while (true) {
              var packet = this.get_next_packet();
              if ((packet.kind == PacketKind.EOS)
                  || (packet.kind == PacketKind.Incomplete))
                  break;
              if ((packet.kind == PacketKind.ESC)
                  || (packet.kind == PacketKind.Unknown))
                  continue;
              if (packet.kind == PacketKind.Text)
                  blocks.push(this.transform_to_html(this.with_state(packet)));
              else if (packet.kind == PacketKind.SGR)
                  this.process_ansi(packet);
              else if (packet.kind == PacketKind.OSCURL)
                  blocks.push(this.process_hyperlink(packet));
          }
          return blocks.join("");
      };
      AnsiUp.prototype.with_state = function (pkt) {
          return { bold: this.bold, italic: this.italic, underline: this.underline, fg: this.fg, bg: this.bg, text: pkt.text };
      };
      AnsiUp.prototype.process_ansi = function (pkt) {
          var sgr_cmds = pkt.text.split(';');
          while (sgr_cmds.length > 0) {
              var sgr_cmd_str = sgr_cmds.shift();
              var num = parseInt(sgr_cmd_str, 10);
              if (isNaN(num) || num === 0) {
                  this.fg = this.bg = null;
                  this.bold = false;
                  this.italic = false;
                  this.underline = false;
              }
              else if (num === 1) {
                  this.bold = true;
              }
              else if (num === 3) {
                  this.italic = true;
              }
              else if (num === 4) {
                  this.underline = true;
              }
              else if (num === 22) {
                  this.bold = false;
              }
              else if (num === 23) {
                  this.italic = false;
              }
              else if (num === 24) {
                  this.underline = false;
              }
              else if (num === 39) {
                  this.fg = null;
              }
              else if (num === 49) {
                  this.bg = null;
              }
              else if ((num >= 30) && (num < 38)) {
                  this.fg = this.ansi_colors[0][(num - 30)];
              }
              else if ((num >= 40) && (num < 48)) {
                  this.bg = this.ansi_colors[0][(num - 40)];
              }
              else if ((num >= 90) && (num < 98)) {
                  this.fg = this.ansi_colors[1][(num - 90)];
              }
              else if ((num >= 100) && (num < 108)) {
                  this.bg = this.ansi_colors[1][(num - 100)];
              }
              else if (num === 38 || num === 48) {
                  if (sgr_cmds.length > 0) {
                      var is_foreground = (num === 38);
                      var mode_cmd = sgr_cmds.shift();
                      if (mode_cmd === '5' && sgr_cmds.length > 0) {
                          var palette_index = parseInt(sgr_cmds.shift(), 10);
                          if (palette_index >= 0 && palette_index <= 255) {
                              if (is_foreground)
                                  this.fg = this.palette_256[palette_index];
                              else
                                  this.bg = this.palette_256[palette_index];
                          }
                      }
                      if (mode_cmd === '2' && sgr_cmds.length > 2) {
                          var r = parseInt(sgr_cmds.shift(), 10);
                          var g = parseInt(sgr_cmds.shift(), 10);
                          var b = parseInt(sgr_cmds.shift(), 10);
                          if ((r >= 0 && r <= 255) && (g >= 0 && g <= 255) && (b >= 0 && b <= 255)) {
                              var c = { rgb: [r, g, b], class_name: 'truecolor' };
                              if (is_foreground)
                                  this.fg = c;
                              else
                                  this.bg = c;
                          }
                      }
                  }
              }
          }
      };
      AnsiUp.prototype.transform_to_html = function (fragment) {
          var txt = fragment.text;
          if (txt.length === 0)
              return txt;
          txt = this.escape_txt_for_html(txt);
          if (!fragment.bold && !fragment.italic && !fragment.underline && fragment.fg === null && fragment.bg === null)
              return txt;
          var styles = [];
          var classes = [];
          var fg = fragment.fg;
          var bg = fragment.bg;
          if (fragment.bold)
              styles.push('font-weight:bold');
          if (fragment.italic)
              styles.push('font-style:italic');
          if (fragment.underline)
              styles.push('text-decoration:underline');
          if (!this._use_classes) {
              if (fg)
                  styles.push("color:rgb(" + fg.rgb.join(',') + ")");
              if (bg)
                  styles.push("background-color:rgb(" + bg.rgb + ")");
          }
          else {
              if (fg) {
                  if (fg.class_name !== 'truecolor') {
                      classes.push(fg.class_name + "-fg");
                  }
                  else {
                      styles.push("color:rgb(" + fg.rgb.join(',') + ")");
                  }
              }
              if (bg) {
                  if (bg.class_name !== 'truecolor') {
                      classes.push(bg.class_name + "-bg");
                  }
                  else {
                      styles.push("background-color:rgb(" + bg.rgb.join(',') + ")");
                  }
              }
          }
          var class_string = '';
          var style_string = '';
          if (classes.length)
              class_string = " class=\"" + classes.join(' ') + "\"";
          if (styles.length)
              style_string = " style=\"" + styles.join(';') + "\"";
          return "<span" + style_string + class_string + ">" + txt + "</span>";
      };
      ;
      AnsiUp.prototype.process_hyperlink = function (pkt) {
          var parts = pkt.url.split(':');
          if (parts.length < 1)
              return '';
          if (!this._url_whitelist[parts[0]])
              return '';
          var result = "<a href=\"" + this.escape_txt_for_html(pkt.url) + "\">" + this.escape_txt_for_html(pkt.text) + "</a>";
          return result;
      };
      return AnsiUp;
  }());
  function rgx(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2);
  }
  function rgxG(tmplObj) {
      var subst = [];
      for (var _i = 1; _i < arguments.length; _i++) {
          subst[_i - 1] = arguments[_i];
      }
      var regexText = tmplObj.raw[0];
      var wsrgx = /^\s+|\s+\n|\s*#[\s\S]*?\n|\n/gm;
      var txt2 = regexText.replace(wsrgx, '');
      return new RegExp(txt2, 'g');
  }
      Object.defineProperty(exports, "__esModule", { value: true });
      exports.default = AnsiUp;
  }));
  // micromodal: https://github.com/Ghosh/micromodal
  !function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).MicroModal=t()}(this,(function(){"use strict";function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var n,i,a,r,s,l=(n=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],i=function(){function o(e){var n=e.targetModal,i=e.triggers,a=void 0===i?[]:i,r=e.onShow,s=void 0===r?function(){}:r,l=e.onClose,c=void 0===l?function(){}:l,d=e.openTrigger,u=void 0===d?"data-micromodal-trigger":d,f=e.closeTrigger,h=void 0===f?"data-micromodal-close":f,v=e.openClass,g=void 0===v?"is-open":v,m=e.disableScroll,b=void 0!==m&&m,y=e.disableFocus,p=void 0!==y&&y,w=e.awaitCloseAnimation,E=void 0!==w&&w,k=e.awaitOpenAnimation,M=void 0!==k&&k,A=e.debugMode,C=void 0!==A&&A;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this.modal=document.getElementById(n),this.config={debugMode:C,disableScroll:b,openTrigger:u,closeTrigger:h,openClass:g,onShow:s,onClose:c,awaitCloseAnimation:E,awaitOpenAnimation:M,disableFocus:p},a.length>0&&this.registerTriggers.apply(this,t(a)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var i,a,r;return i=o,(a=[{key:"registerTriggers",value:function(){for(var e=this,t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];o.filter(Boolean).forEach((function(t){t.addEventListener("click",(function(t){return e.showModal(t)}))}))}},{key:"showModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var o=function t(){e.modal.removeEventListener("animationend",t,!1),e.setFocusToFirstNode()};this.modal.addEventListener("animationend",o,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,t)}},{key:"closeModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,e),this.config.awaitCloseAnimation){var o=this.config.openClass;this.modal.addEventListener("animationend",(function e(){t.classList.remove(o),t.removeEventListener("animationend",e,!1)}),!1)}else t.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(e){this.modal=document.getElementById(e),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(e){if(this.config.disableScroll){var t=document.querySelector("body");switch(e){case"enable":Object.assign(t.style,{overflow:""});break;case"disable":Object.assign(t.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(e){(e.target.hasAttribute(this.config.closeTrigger)||e.target.parentNode.hasAttribute(this.config.closeTrigger))&&(e.preventDefault(),e.stopPropagation(),this.closeModal(e))}},{key:"onKeydown",value:function(e){27===e.keyCode&&this.closeModal(e),9===e.keyCode&&this.retainFocus(e)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(n);return Array.apply(void 0,t(e))}},{key:"setFocusToFirstNode",value:function(){var e=this;if(!this.config.disableFocus){var t=this.getFocusableNodes();if(0!==t.length){var o=t.filter((function(t){return!t.hasAttribute(e.config.closeTrigger)}));o.length>0&&o[0].focus(),0===o.length&&t[0].focus()}}}},{key:"retainFocus",value:function(e){var t=this.getFocusableNodes();if(0!==t.length)if(t=t.filter((function(e){return null!==e.offsetParent})),this.modal.contains(document.activeElement)){var o=t.indexOf(document.activeElement);e.shiftKey&&0===o&&(t[t.length-1].focus(),e.preventDefault()),!e.shiftKey&&t.length>0&&o===t.length-1&&(t[0].focus(),e.preventDefault())}else t[0].focus()}}])&&e(i.prototype,a),r&&e(i,r),o}(),a=null,r=function(e){if(!document.getElementById(e))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(e,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(e,'"></div>')),!1},s=function(e,t){if(function(e){e.length<=0&&(console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>'))}(e),!t)return!0;for(var o in t)r(o);return!0},{init:function(e){var o=Object.assign({},{openTrigger:"data-micromodal-trigger"},e),n=t(document.querySelectorAll("[".concat(o.openTrigger,"]"))),r=function(e,t){var o=[];return e.forEach((function(e){var n=e.attributes[t].value;void 0===o[n]&&(o[n]=[]),o[n].push(e)})),o}(n,o.openTrigger);if(!0!==o.debugMode||!1!==s(n,r))for(var l in r){var c=r[l];o.targetModal=l,o.triggers=t(c),a=new i(o)}},show:function(e,t){var o=t||{};o.targetModal=e,!0===o.debugMode&&!1===r(e)||(a&&a.removeEventListeners(),(a=new i(o)).showModal())},close:function(e){e?a.closeModalById(e):a.closeModal()}});return"undefined"!=typeof window&&(window.MicroModal=l),l}));  
  window.define = window.backupDefine; window.backupDefine = undefined;
  </script>
<script type="text/javascript">
  (function () {
    // forward keydown events so shortcuts can work in vscode, see:
    // https://github.com/microsoft/vscode/issues/65452#issuecomment-586485815
    if (window.parent.postMessage) {
      window.document.addEventListener('keydown', e => {
        const event = {
          type: "keydown",
          data: {
            altKey: e.altKey,
            code: e.code,
            ctrlKey: e.ctrlKey,
            isComposing: e.isComposing,
            key: e.key,
            location: e.location,
            metaKey: e.metaKey,
            repeat: e.repeat,
            shiftKey: e.shiftKey
          }
        };
        window.parent.postMessage(event, '*');
      });
    }
    // listen for execCommand messages
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-exec-command") {
        window.document.execCommand(event.data.data);
      } 
    }, true);
    const logEntries = new Array(1000);
    logEntries.offset = 0;
    function recordLogEntry(entry) {
      logEntries[logEntries.offset++] = entry;
      logEntries.offset %= logEntries.length;
    }
    function getLogEntry(i) { // backwards, 0 is most recent
        return logEntries[(logEntries.offset - 1 - i + logEntries.length) % logEntries.length];
    }
    const protocol = window.location.protocol === "https:" ? "wss:" : "ws:";
    let path = window.location.pathname;
    if (!/\/$/.test(path)) path += "/";
    const devServerSocket = new WebSocket(protocol + "//" + window.location.host + path);
    let reloadPage = true;
    addEventListener("beforeunload", () => {
      // don't reload page in case of navigation events
      reloadPage = false;
    })
    devServerSocket.onopen = () => {
      console.log('Socket connection open. Listening for events.');
      // if the socket closes for any reason (e.g. this occurs in electron apps
      // when the computer suspends) then reload to reestablish the connection 
      devServerSocket.onclose = () => {
        if (reloadPage) {
          console.log('Socket connection closed. Reloading.');
          window.location.reload(true);
        }
      }
    };
    // append for errors that occur within the error window
    let lastError = 0;
    const kErrorWindow = 2500;
    function showError(msg) {
      const ansiUp = new AnsiUp
      const html = ansiUp.ansi_to_html(msg.trim());
      const display = document.getElementById("quarto-log-error-display");
      if (display.innerHTML && ((Date.now() - lastError) < kErrorWindow)) {
        display.innerHTML = display.innerHTML + "<br/>" +  html;
      } else {
        display.innerHTML = html
      }
      lastError = Date.now()
      MicroModal.show('quarto-log-error-modal', {
        awaitCloseAnimation: true,
        onClose: () => { display.innerHTML = ""; }
      });
      // post message to parent indicating we had an error
      if (window.parent.postMessage) {
        window.parent.postMessage({
          type: "error",
          msg: msg,
        }, "*");
      }
    }
    // see if there is already an error to show
    const renderError = document.getElementById("quarto-render-error");
    if (renderError) {
      showError(renderError.innerHTML.trim());
    }
    const normalizeTarget = (target) => {
      return target.replace(/\/index\.html/, "/")
    };
    devServerSocket.onmessage = (msg) => {
      if (msg.data.startsWith('reload')) {
        let target = normalizeTarget(msg.data.replace(/^reload/, ""));
        // prepend proxy path to target if we have one
        if (target) {
          const pathPrefix = 
            window.location.pathname.match(/^.*?\/p\/\w+\//) ||
            window.location.pathname.match(/^.*?\/user\/[\w\d]+\/proxy\/\d+\//);
          if (pathPrefix) {
            target = pathPrefix + target.slice(1);
          }
        }
        if (target && (target !== normalizeTarget(window.location.pathname))) {
          window.location.replace(target);
        } else {
          window.location.reload(true);
        }
      } else if (msg.data.startsWith('log:')) {
        const ansiUp = new AnsiUp
        const log = JSON.parse(msg.data.substr(4));
        recordLogEntry(log);
        if (log.levelName === "ERROR") {
          showError(log.msgFormatted)
        } else {
          // see if there is a knitr error to report
          const kExecutionHalted = "Execution halted";
          if (log.msg.indexOf(kExecutionHalted) !== -1) {
            // scan backwards for beginning of error
            const errorEntries = [getLogEntry(0).msgFormatted];
            for (let i=1; i<logEntries.length; i++) {
              const logEntry = getLogEntry(i);
              if (logEntry) {
                errorEntries.unshift(logEntry.msgFormatted);
                if (logEntry.msg.indexOf("Quitting from lines") !== -1) {
                  showError(errorEntries.join(""));
                  break;
                } else if (logEntry.msg.indexOf(kExecutionHalted) !== -1) {
                  break;
                }
              } else {
                break;
              }
            }
          }
        }
      }
    };
  })();
</script>

<script type="text/javascript">
  if (window.parent.postMessage) {
    // wait for message providing confirmation we are in a devhost
    window.addEventListener("message", function (event) {
      if (event.data.type === "devhost-init") {
        window.quartoDevhost = {
          openInputFile: function (line, column, highlight) {
            window.parent.postMessage({
              type: "openfile",
              file: "/Users/brandonrodriguez/Downloads/LinearModelingContentV2.qmd",
              line: line,
              column: column,
              highlight: highlight
            }, event.origin);
          }
        };
      } else if (event.data.type === "goback") {
        window.history.back()
      } else if (event.data.type === "goforward") {
        window.history.forward()
      }
    }, true);
    // notify host of navigation (e.g. for 'pop out' command)
    window.parent.postMessage({
      type: "navigate",
      href: window.location.href,
      file: "/Users/brandonrodriguez/Downloads/LinearModelingContentV2.qmd"
    }, "*");
  }
</script>
</body></html>
